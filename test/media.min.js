/* Media - Testing css media queries in Javascript. Authors & copyright (c) 2012: WebLinc, David Knight, Zac Owen. */

(function(d){function n(b){return{name:b||"all",test:function(){return this.name===Media.type}}}function p(b,a,e){var c=Media.features[b];return{name:b,value:a,type:e,test:function(){var a=Media.getAbsValue(this.value);return"min"===this.type?c>=a:"max"===this.type?c<=a:"undefined"!==this.value?c===a:Number(c)}}}function q(b){var a=g;g++;return{matches:Media.parseMatch(b,!1),media:b,addListener:function(b){Media.queries[a]||(Media.queries[a]={mql:this,listeners:[]});Media.queries[a].listeners.push(b)},
removeListener:function(b){var c=Media.queries[a];if(c)for(var d=0,f=c.listeners.length;d<f;d++)c.listeners[d]===b&&c.listeners.splice(d,1)}}}var k=d.document,f=k.getElementsByTagName("head")[0],f=d.getComputedStyle&&d.getComputedStyle(f,null)||f.currentStyle,l=k.documentElement,g=0,m=0;d.Media={supported:1===parseFloat(f.height),type:"all screen print speech projection handheld tv braille embossed tty".split(" ")[parseFloat(f.zIndex)],queries:[],features:{width:0,height:0,"aspect-ratio":0,color:screen.colorDepth,
"color-index":Math.pow(2,screen.colorDepth),"device-aspect-ratio":(screen.width/screen.height).toFixed(2),"device-width":screen.width,"device-height":screen.height,monochrome:Number(2==screen.colorDepth),orientation:"landscape",resolution:screen.deviceXDPI||parseFloat(f.width)},getAbsValue:function(b){var a;return(a=b.match(/([\d\.]+)(px|em|rem|%|in|cm|mm|ex|pt|pc)/))?"em"==a[2]?16*a[1]:"pt"==a[2]?Media.features.resolution/72*a[1]:a[1]:(a=b.match(/(\d+)[\/:](\d+)/))?a[1]/a[2]:(a=b.match(/([\d]+)(dpi|dppx|dpcm)/))?
"dpcm"==a[2]?0.3937*a[1]:"dppx"==a[2]?96*a[1]:a[1]:b},parseMatch:function(b,a){var e="string"===typeof b?b.split(", "):b,c=-1!==e[e.length-1].indexOf("not "),d=e.pop(),f="all",h=d.split(" and "),i=h.length-1,g=!c;do{var j=null;if(-1===h[i].indexOf("("))if(f=n(h[i].match(/(not)?\s*(\w*)/)[2]),f.test())continue;else return e.length?this.parseMatch(e,a):c;if((j=h[i].match(/\(\s*(min|max)?-?([^:\s]+)\s*:\s*([^\s]+)\s*\)/))&&!p(j[2],j[3],j[1]).test())return e.length?this.parseMatch(e,a):c}while(i--);return a&&
g&&{matches:g,type:c?"all, screen, print, speech, projection, handheld, tv, braille, embossed, tty".split(f).join(", ").replace(/(,\s){2}/,""):f,media:d}||g},match:function(b){return new q(b)},watch:function(b){clearTimeout(m);m=setTimeout(function(){var a=g;Media.setMutableFeatures();do{var e=Media.queries[a],c=!1;if("undefined"!==typeof e&&((c=Media.parseMatch(e.mql.media))&&!e.mql.matches||!c&&e.mql.matches)){e.mql.matches=c;for(var c=0,f=e.listeners.length;c<f;c++)e.listeners[c]&&e.listeners[c].call(d,
e.mql,b)}}while(a--)},10)},setMutableFeatures:function(){Media.features.width=d.innerWidth||l.clientWidth;Media.features.height=d.innerHeight||l.clientHeight;Media.features["aspect-ratio"]=(Media.features.width/Media.features.height).toFixed(2);Media.features.orientation=Media.features.height>=Media.features.width?"portrait":"landscape"},listen:function(b){d.addEventListener?(d.addEventListener("resize",b),d.addEventListener("orientationchange",b)):d.attachEvent&&(d.attachEvent("onresize",b),d.attachEvent("onorientationchange",
b))}};Media.setMutableFeatures();Media.listen(Media.watch)})(window);