/* Media - Testing css media queries in Javascript. Authors & copyright (c) 2012: WebLinc, David Knight, Zac Owen. */

(function(c){function n(b){return{name:b||"all",test:function(){return this.name===Media.type}}}function p(b,a,q){var d=Media.features[b];return{name:b,value:a,type:q,test:function(){var a=Media.getAbsValue(this.value);return"min"===this.type?d>=a:"max"===this.type?d<=a:"undefined"!==this.value?d===a:Number(d)}}}function r(b){var a=f;f++;return{matches:Media.parseMatch(b,!1),media:b,addListener:function(b){Media.queries[a]||(Media.queries[a]={mql:this,listeners:[]});Media.queries[a].listeners.push(b)},
removeListener:function(b){var d=Media.queries[a];if(d)for(var c=0,e=d.listeners.length;c<e;c++)d.listeners[c]===b&&d.listeners.splice(c,1)}}}var h=c.document,e=h.getElementsByTagName("head")[0],e=c.getComputedStyle&&c.getComputedStyle(e,null)||e.currentStyle,l=h.documentElement,f=0,m=0;c.Media={supported:1===parseFloat(e.height),type:"all screen print speech projection handheld tv braille embossed tty".split(" ")[parseFloat(e.zIndex)],queries:[],features:{width:0,height:0,"aspect-ratio":0,color:screen.colorDepth,
"color-index":Math.pow(2,screen.colorDepth),"device-aspect-ratio":c.devicePixelRatio||(screen.width/screen.height).toFixed(2),"device-width":screen.width,"device-height":screen.height,monochrome:Number(2==screen.colorDepth),orientation:"landscape",resolution:screen.deviceXDPI||parseFloat(e.width)},getAbsValue:function(b){var a;return(a=b.match(/([\d\.]+)(px|em|rem|%|in|cm|mm|ex|pt|pc)/))?"em"==a[2]?16*a[1]:"pt"==a[2]?Media.features.resolution/72*a[1]:parseFloat(a[1]):(a=b.match(/(\d+)[\/:](\d+)/))?
a[1]/a[2]:(a=b.match(/([\d]+)(dpi|dppx|dpcm)/))?"dpcm"==a[2]?0.3937*a[1]:"dppx"==a[2]?96*a[1]:a[1]:b},parseMatch:function(b,a){var c="string"===typeof b?b.split(", "):b,d=-1!==c[c.length-1].indexOf("not "),e=c.pop(),g="all",i=e.split(" and "),j=i.length-1,f=!d;do{var k=null;if(-1===i[j].indexOf("("))if(g=n(i[j].match(/(not)?\s*(\w*)/)[2]),g.test())continue;else return c.length?this.parseMatch(c,a):d;if((k=i[j].match(/\(\s*(min|max)?-?([^:\s]+)\s*:\s*([^\s]+)\s*\)/))&&!p(k[2],k[3],k[1]).test())return c.length?
this.parseMatch(c,a):d}while(j--);return a&&f&&{matches:f,type:d?"all, screen, print, speech, projection, handheld, tv, braille, embossed, tty".split(g).join(", ").replace(/(,\s){2}/,""):g,media:e}||f},match:function(b){return new r(b)},watch:function(b){clearTimeout(m);m=setTimeout(function(){var a=f;Media.setMutableFeatures();do{var e=Media.queries[a],d=!1;if("undefined"!==typeof e&&((d=Media.parseMatch(e.mql.media))&&!e.mql.matches||!d&&e.mql.matches)){e.mql.matches=d;for(var d=0,h=e.listeners.length;d<
h;d++)e.listeners[d]&&e.listeners[d].call(c,e.mql,b)}}while(a--)},10)},setMutableFeatures:function(){Media.features.width=c.innerWidth||l.clientWidth;Media.features.height=c.innerHeight||l.clientHeight;Media.features["aspect-ratio"]=(Media.features.width/Media.features.height).toFixed(2);Media.features.orientation=Media.features.height>=Media.features.width?"portrait":"landscape"},listen:function(b){c.addEventListener?(c.addEventListener("resize",b),c.addEventListener("orientationchange",b)):c.attachEvent&&
(c.attachEvent("onresize",b),c.attachEvent("onorientationchange",b))}};Media.setMutableFeatures();Media.listen(Media.watch)})(window);